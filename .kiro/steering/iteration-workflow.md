# イテレーションワークフロー

## 更新日時
2024年12月31日（火）

---

## 重要ルール: 自律的PDCAサイクル

**このプロジェクトでは、AIが自律的にPDCAサイクルを回し続ける。**

1. **Plan**: 課題を特定し、方針を立てる
2. **Do**: 実装を行う
3. **Check**: シミュレーションを実行し、結果を検証する
4. **Act**: レポートを作成し、次の課題を特定する

**要所での確認は不要。** とにかくサイクルを回し続け、プロジェクトを前進させる。

### 絶対に止まらないこと
- 1つのサイクルが完了したら、即座に次のサイクルを開始する
- ユーザーの確認を待たない
- 仮説が棄却されても、新しい仮説を立てて検証を続ける

### 外部フィードバックの確認
- 各PDCAサイクルのどこかで `.kiro/feedbacks/other-ai.md` を確認する
- フィードバックがあれば、それを参考にして次の方針を決める
- 読み取った後、ファイルの中身は空にする
- ファイルが空または存在しない場合は無視して続行

---

## 概要

このファイルは、シミュレーション開発のイテレーションワークフローを定義する。
検証完了後に次のステップを見つけ、実装を進めるプロセスを標準化する。

---

## ワークフロー

### Phase 1: 検証完了の確認

1. シミュレーションを実行し、結果を観測
2. 個別レポート（`YYYY-MM-DD-{topic}.md`）を作成
3. CONCLUSIONS.mdを更新（結論の追加/更新、仮説のステータス変更）

### Phase 2: 次のステップの特定

以下の優先順位で次のステップを決定:

1. **技術的負債の解消**
   - 前回指摘された懸念点
   - 未接続の機能（例: 知覚が意思決定に使われていない）
   - 定義のズレ（例: Beacon強度の計算式の不整合）

2. **検証中の仮説の検証**
   - CONCLUSIONS.mdの「仮説（検証中）」セクションを確認
   - 検証可能な仮説を選択

3. **未解決の問いへのアプローチ**
   - Q1-Q3の検証に必要な前提条件を確認
   - 前提条件が欠けていれば、それを実装

4. **活発レジームの維持・拡張**
   - 現在のパラメータで「活発」レジームに入れているか確認
   - より複雑な創発を観測できる改善を検討

### Phase 3: 非恣意性チェック

次のステップを決定する前に、以下を確認:

- [ ] 新しい公理を追加する必要があるか？
  - YES → 公理予算ルールに従い、必要性を明文化
  - NO → 既存公理の拡張として実装可能か確認
- [ ] 特定の成果を誘導していないか？
  - 「言語が生まれるように」「協力が発生するように」などの意図がないか
- [ ] 観測のみの原則に沿っているか？
  - メトリクスは目的関数ではなくログとして使用

### Phase 4: スペック作成

1. `.kiro/specs/{feature-name}/original-idea.md`にアイデアを記録
2. `requirements.md`を作成（EARS形式）
3. `design.md`を作成
4. `tasks.md`を作成

### Phase 5: 実装

1. タスクを順に実行
2. チェックポイントでテストを実行
3. 検証シミュレーションを実行

### Phase 6: 検証とレポート

1. 実装した機能の効果を検証
2. 個別レポートを作成
3. CONCLUSIONS.mdを更新
4. Phase 1に戻る

---

## 現在の状態（自動更新）

### 最新の検証結果
- **日時**: 2024-12-31
- **内容**: H81/H83/H84検証（方言圏と親子ペアの関係、世代時間）
- **結果**: H81強く支持（親子ペア率2.9倍）、H83支持（親子ペアなし維持率0%）、H84棄却（相関0.12）
- **レポート**: `2024-12-31-parent-child-spatial.md`, `2024-12-31-dialect-continuity.md`, `2024-12-31-generation-time.md`

### 技術的負債
1. ~~maintainerの+1 hop知覚が意思決定に使われていない~~（優先度: 低）
2. ~~Beacon強度の定義が行動系と統計でズレている~~（優先度: 低）
3. ~~情報→行動の接続が不完全~~（解決済み: State特徴量を実装、A/B比較で効果確認）
4. ~~イベント欠落~~（解決済み: clearEventLog()を追加）
5. ~~レジーム探索の誤集計~~（解決済み: logFrequency=1に変更、毎tick累積）
6. ~~エネルギーが負になり得る~~（解決済み: 行動前にエネルギーチェック追加）
7. ~~tick0イベント欠落~~（解決済み: runner.tsで初期化直後のイベントを取得）
8. **統計の「このtick」と「累積」が混在**: 探索/比較系で問題（優先度: 中）
9. **P0問題（フィードバック）**: イベントログ累積過大計上、Map JSON化、rngState再現不能など
10. **タイプの多様性がない**: H8検証不可能（タイプが1種類のみ）

### 検証待ちの仮説
- H79: 方言圏の維持には「移動の制限」が必要（検証中）
- H85: 方言圏の維持には「継続的な親子ペアの生成」が必要（検証中）
- H86: 世代時間は「人口密度」に依存する（検証中）
- H87: 複製数は資源再生率に強く依存する（**支持**: 相関0.985）

### 確立された結論（本セッション）
- 結論22: 方言圏の形成には「適度なノード人口」（2-4体）が必要（H78）
- 結論23: 親子ペアの類似度は非親子ペアより高い（H80: 7.54倍）
- 結論24: 世代数が離れるほど類似度は低下する（H82: 相関-0.83）
- H81: 方言圏は親子ペアの空間的集中によって形成される（**強く支持**: 2.9倍）
- H83: 方言圏の維持には継続的な親子ペアの存在が必要（**支持**: 親子ペアなし維持率0%）

### 棄却された仮説
- H51: 「文明の罠」は成長の自然な帰結であり、回避不可能（棄却: 回復率96.8%）
- H55: 罠からの回復時間は人口減少の程度に依存する（棄却: 相関-0.038）
- H61: 停滞からの脱出には「協力率の増加」が重要な役割を果たす（棄却: 相関0.002）
- H69: 移動頻度が高いと方言圏は収束する（棄却: 検証方法に問題あり）
- H70: 人口増加は新しい方言圏を生む（棄却: 人口増加は方言圏を減らす、相関-0.587）
- H71: 方言圏の形成には「適度な人口密度」が必要（棄却: 人口密度と方言圏数に相関なし）
- H72: 方言圏数は「人口/ノード数」の比率で決まる（棄却: ノード数を変えても方言圏数は変わらない）
- H75: 方言圏は長期的に安定する（棄却: 持続率3.1%）
- H76: 方言圏の不安定性は「人口変動」に起因する（棄却: 変化量相関0.164）
- H84: 世代時間は環境条件（資源再生率など）に依存する（棄却: 相関0.12）

### 次のステップ候補
1. **H79の検証**: 方言圏の維持には「移動の制限」が必要
2. **H86の検証**: 世代時間は「人口密度」に依存する
3. **言語創発の最終総括**: H78-H87の結果を統合
4. **Gitプッシュ**: 重要な進捗をプッシュ

---

## 参照ファイル

- #[[file:.kiro/reports/CONCLUSIONS.md]]
- #[[file:.kiro/steering/project-rules.md]]
- #[[file:.kiro/ideas/README.md]]
